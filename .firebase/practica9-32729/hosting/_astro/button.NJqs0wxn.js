import{j as d}from"./jsx-runtime.CLpGMVip.js";import{r as f}from"./index.BL7xzsR_.js";const l="https://firestore.googleapis.com/v1/projects/practica9-32729/databases/(default)/documents/carts",c="AIzaSyAFZJ63l3c1xErKyYnzC12_EP1xkJCuW4Y",h=async t=>{if(!t||typeof t!="string")return console.error("Error: userId inválido",t),[];const r=`${l}/${t}?key=${c}`;console.log("Obteniendo items del carrito para userId:",t,"con URL:",r);try{const o=await fetch(r),s=await o.json();if(console.log("Respuesta de Firestore:",JSON.stringify(s,null,2)),o.status===404)return console.log("El carrito no existe, devolviendo array vacío."),[];if(!o.ok)throw new Error(`Error en Firestore: ${s.error?.message||"Error desconocido"}`);if(!s.fields||!s.fields.items)return console.log("No hay elementos en el carrito."),[];const a=s.fields.items.arrayValue.values.map(e=>({id:e.mapValue.fields.id?.stringValue||"",imagen:e.mapValue.fields.imagen?.stringValue||"",titulo:e.mapValue.fields.titulo?.stringValue||"Sin título",precio:e.mapValue.fields.precio?.doubleValue||0,instructor:e.mapValue.fields.instructor?.stringValue||"Desconocido"}));return console.log("Cursos en el carrito después del mapeo:",a),a}catch(o){return console.error("Error obteniendo el carrito:",o),[]}},b=async(t,r)=>{const o=`${l}/${t}?key=${c}`,s=await fetch(o),a=await s.json();let e=[];return s.ok&&a.fields?.items&&(e=a.fields.items.arrayValue.values||[],e.some(u=>u.mapValue.fields.titulo.stringValue===r.titulo))?(alert("¡Este curso ya está en tu carrito!"),!1):(e.push({mapValue:{fields:{id:{stringValue:r.id},titulo:{stringValue:r.titulo},imagen:{stringValue:r.imagen},precio:{doubleValue:r.precio},instructor:{stringValue:r.instructor}}}}),(await fetch(o,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({fields:{items:{arrayValue:{values:e}}}})})).ok?!0:(console.error("Error al añadir el curso al carrito."),!1))},V=async(t,r)=>{const o=`${l}/${t}?key=${c}`,s=await fetch(o),a=await s.json();if(!s.ok||!a.fields?.items){console.error("No se encontró el carrito.");return}const e=a.fields.items.arrayValue.values.filter(i=>i.mapValue.fields.id.stringValue!==r);(await fetch(o,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({fields:{items:{arrayValue:{values:e}}}})})).ok||console.error("Error al eliminar el curso del carrito.")};function p(...t){return t.filter(Boolean).join(" ")}const m=f.forwardRef(({className:t,variant:r="default",size:o="default",...s},a)=>{const e="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",n={default:"bg-primary text-white hover:bg-primary/90",destructive:"bg-red-600 text-white hover:bg-red-500",outline:"border border-gray-300 bg-white hover:bg-gray-100",secondary:"bg-gray-200 text-gray-800 hover:bg-gray-300",ghost:"hover:bg-gray-100",link:"text-blue-600 underline-offset-4 hover:underline"},i={default:"h-10 px-4 py-2",sm:"h-9 px-3 rounded-md",lg:"h-11 px-8 rounded-md",icon:"h-10 w-10 flex items-center justify-center"};return d.jsx("button",{ref:a,className:p(e,n[r],i[o],t),...s})});m.displayName="Button";export{m as B,b as a,h as g,V as r};
